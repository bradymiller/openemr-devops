# Kcov Coverage for OpenEMR Entrypoint Scripts

This directory contains code coverage reports generated by [kcov](https://github.com/SimonKagstrom/kcov/) for the OpenEMR entrypoint scripts.

## How it works

1. For the `flex-edge` image, the GitHub Actions workflow builds the Docker image with the `kcov` target, which includes the Kcov code coverage tool.
2. The container runs with a wrapper script that executes the original `openemr.sh` entrypoint script under kcov monitoring.
3. Kcov collects coverage data on which lines of code were executed in the entrypoint script.
4. After tests complete, the coverage reports are uploaded as artifacts in the GitHub Actions workflow.

## Accessing the coverage reports

1. Go to the GitHub Actions run for your build.
2. Click on the "Artifacts" section.
3. Download the `kcov-coverage-reports` artifact.
4. Extract the archive and open `index.html` in your web browser.

## Coverage report structure

The coverage reports include:

- Line-by-line coverage information for the entrypoint scripts
- Summary statistics showing coverage percentages
- Visual indicators showing which code paths were executed

## Local testing with coverage

To run the container locally with coverage enabled:

1. Set the Docker context path to `flex-edge`
2. Use the `kcov` profile with Docker Compose
3. Coverage reports will be available in the `coverage-reports/` directory

```bash
cd docker/openemr
DOCKER_CONTEXT_PATH=flex-edge COMPOSE_PROFILES=kcov docker compose up
```

After running, you can view the coverage reports in `docker/openemr/coverage-reports/`.
